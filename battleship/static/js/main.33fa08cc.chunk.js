(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{17:function(t,n,e){},18:function(t,n,e){},20:function(t,n,e){"use strict";e.r(n);var o,r=e(2),a=e.n(r),i=e(9),c=e.n(i),u=(e(17),e(1)),l=e(4),d=e(5),f=e(12),s=e(11),h=(e(18),e(10)),b=e(8);!function(t){t.None="none",t.Head="head",t.Body="body"}(o||(o={}));var j,m=10,v=y(m,m,{placement:o.None}),p=[[{placement:o.None},{placement:o.Head},{placement:o.None}],[{placement:o.Body},{placement:o.Body},{placement:o.Body}],[{placement:o.None},{placement:o.Body},{placement:o.None}],[{placement:o.Body},{placement:o.Body},{placement:o.Body}]],O=[[{bomb:!0}]];function y(t,n,e){return new Array(t).fill(null).map((function(t){return new Array(n).fill(k(e))}))}function x(t,n){return t.map((function(t,e){return t.map((function(t,o){return n(e,o,t)}))}))}function B(t,n,e){var o=n;return x(t,(function(t,n,r){o=e(t,n,r,o)})),o}function g(t){var n=w(t),e=y(n.ncol,n.nrow,{placement:o.None});return x(e,(function(o,r,a){e[o][r]=t[n.nrow-1-r][o]})),e}function w(t){return{nrow:t.length,ncol:t[0].length}}function k(t){return JSON.parse(JSON.stringify(t))}function H(t){return{choice:!1,datum:t}}function N(t,n,e){return t.choice?n(t.datum):e(t.datum)}function S(t,n,e,r){n=k(n);for(var a=w(t),i=w(n),c=0;c<a.nrow;c++)for(var u=0;u<a.ncol;u++)if(t[c][u].placement!==o.None){var l=e+c,d=r+u;if(!(0<=l&&l<i.nrow&&0<=d&&d<i.ncol))return H("out of range");if(n[l][d].placement!==o.None)return H("overlap!");n[l][d].placement=t[c][u].placement}return{choice:!0,datum:n}}function C(t,n,e,o){n=k(n);for(var r=w(t),a=w(n),i=0;i<r.nrow;i++)for(var c=0;c<r.ncol;c++){var l=e+i,d=o+c;0<=l&&l<a.nrow&&0<=d&&d<a.ncol&&(n[l][d]=Object(u.a)(Object(u.a)({},n[l][d]),t[i][c]))}return n}function M(t,n){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,o=t;o>0;o--)for(var r=!1;!r;){var a=Math.floor(4*Math.random());new Array(a).fill(null).forEach((function(t){n=g(n)}));var i=Math.floor(Math.random()*m),c=Math.floor(Math.random()*m);N(S(n,e,i,c),(function(t){r=!0,e=t}),(function(t){}))}return e}function F(t){return!B(t,!1,(function(t,n,e,r){var a=!e.bomb&&e.placement===o.Head;return r||a}))}function E(t,n){return B(n,!0,(function(n,e,r,a){var i;return i=r===j.HitBody?t[n][e].placement===o.Body:r===j.HitHead?t[n][e].placement===o.Head:r!==j.HitNone||t[n][e].placement===o.None,a&&i}))}!function(t){t.Unknown="unknown",t.HitHead="head",t.HitBody="body",t.HitNone="none"}(j||(j={}));var P=function(){function t(n,e){Object(l.a)(this,t),this.totalCount=void 0,this.item=void 0,this.explanations=void 0,this.totalCount=n,this.item=e,this.explanations=[]}return Object(d.a)(t,[{key:"generateExplanation",value:function(t,n){for(var e=this.totalCount,o=this.item,r=[],a=0;a<1e3;a++){var i=M(e,o);E(i,n)&&r.push(i)}return r}},{key:"nextStep",value:function(t){var n=w(t),e=n.nrow,r=n.ncol;this.explanations=this.explanations.filter((function(n){return E(n,t)})),this.explanations=[].concat(Object(b.a)(this.explanations),Object(b.a)(this.generateExplanation(this.explanations,t)));var a,i=y(e,r,0),c=Object(h.a)(this.explanations);try{for(c.s();!(a=c.n()).done;){x(a.value,(function(n,e,r){r.placement===o.Head&&t[n][e]===j.Unknown&&(i[n][e]+=1)}))}}catch(f){c.e(f)}finally{c.f()}var u=B(i,{i:-1,j:-1,count:-1},(function(t,n,e,o){return e>o.count?{i:t,j:n,count:e}:o})),l=u.i,d=u.j;u.count;return{i:l,j:d}}}]),t}(),J=e(0);function A(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,n){},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,n){};return Object(J.jsx)("div",{className:"Board",children:Object(J.jsx)("table",{children:Object(J.jsx)("tbody",{children:Object(J.jsx)(J.Fragment,{children:t.map((function(t,o){return Object(J.jsx)("tr",{children:Object(J.jsx)(J.Fragment,{children:t.map((function(t,r){return Object(J.jsx)("td",{className:"airplane-"+t.placement+(t.overlay?" overlay":"")+(t.bomb?" bomb":""),onClick:function(){return n(o,r)},onMouseEnter:function(){return e(o,r)},children:" "})}))})})}))})})})})}var U=function(t){Object(f.a)(e,t);var n=Object(s.a)(e);function e(t){var o;return Object(l.a)(this,e),(o=n.call(this,t)).state=o.initState(),o}return Object(d.a)(e,[{key:"initState",value:function(){return{kind:"setup",global:v,item:p,count:3,totalCount:3,hover:void 0}}},{key:"render",value:function(){var t=this,n=this.state;if("setup"===n.kind){var e=n.global;return n.hover&&(e=function(t,e){var r=w(n.item);return t-=Math.floor(r.nrow/2),e-=Math.floor(r.ncol/2),C(x(n.item,(function(t,n,e){return e.placement===o.Head||e.placement===o.Body?{overlay:!0}:{overlay:!1}})),n.global,t,e)}(n.hover.i,n.hover.j)),Object(J.jsxs)("div",{children:[A(e,(function(e,o){if(n.count>0){var r=w(n.item);e-=Math.floor(r.nrow/2),o-=Math.floor(r.ncol/2),N(S(n.item,n.global,e,o),(function(e){return t.setState(Object(u.a)(Object(u.a)({},n),{},{global:e,count:n.count-1}))}),(function(t){}))}}),(function(e,o){t.setState(Object(u.a)(Object(u.a)({},n),{},{hover:{i:e,j:o}}))})),Object(J.jsxs)("div",{onClick:function(){t.setState(Object(u.a)(Object(u.a)({},n),{},{item:g(n.item)}))},children:[A(n.item)," \xd7 ",n.count]}),Object(J.jsx)("button",{disabled:n.count>0,onClick:function(e){t.setState(Object(u.a)(Object(u.a)({},n),{},{kind:"fighting",ourBoard:n.global,theirBoard:M(n.totalCount,n.item),theirPlayer:new P(n.totalCount,n.item)}))},children:"Start"})]})}if("fighting"===n.kind){var r=function(e,r){var a=C(O,n.theirBoard,e,r);if(F(a))t.setState(Object(u.a)(Object(u.a)({},n),{},{theirBoard:a,kind:"end",winner:"us"}));else{var i=n.theirPlayer.nextStep(function(t){return x(t,(function(t,n,e){return e.bomb?e.placement===o.Head?j.HitHead:e.placement===o.Body?j.HitBody:j.HitNone:j.Unknown}))}(n.ourBoard)),c=i.i,l=i.j,d=C(O,n.ourBoard,c,l);F(d)?t.setState(Object(u.a)(Object(u.a)({},n),{},{theirBoard:a,ourBoard:d,kind:"end",winner:"them"})):t.setState(Object(u.a)(Object(u.a)({},n),{},{theirBoard:a,ourBoard:d}))}};return Object(J.jsxs)("div",{children:[A(n.ourBoard),Object(J.jsx)("div",{children:"-----------------------"}),Object(J.jsxs)("div",{className:"their",children:[n.theirPlayer.explanations.length,A(n.theirBoard,(function(t,n){return r(t,n)}))]})]})}if("end"===n.kind){var a={us:"You won!",them:"You lost!"}[n.winner];return Object(J.jsxs)("div",{children:[a,A(n.ourBoard),Object(J.jsx)("div",{children:"-----------------------"}),A(n.theirBoard),Object(J.jsx)("button",{onClick:function(n){return t.setState(t.initState())},children:"Restart"})]})}}}]),e}(a.a.Component);var I=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,21)).then((function(n){var e=n.getCLS,o=n.getFID,r=n.getFCP,a=n.getLCP,i=n.getTTFB;e(t),o(t),r(t),a(t),i(t)}))};c.a.render(Object(J.jsx)(a.a.StrictMode,{children:Object(J.jsx)(U,{})}),document.getElementById("root")),I()}},[[20,1,2]]]);
//# sourceMappingURL=main.33fa08cc.chunk.js.map